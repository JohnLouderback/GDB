$(function(){window.GDB=function(modelsToMonitorObject,userOptionsObject){this.helpers={isEventSupported:function(e){var t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};var n=document.createElement(t[e]||"div");e="on"+e;var r=e in n;if(!r){n.setAttribute(e,"return;");r=typeof n[e]=="function"}n=null;return r}};var GDB=this;var options={rootElementSelectorString:"body",templateOpeningDelimiter:"<<",templateClosingDelimiter:">>",realtime:true,dataBindToAttr:"data-bindto",dataBindToTemplateAttr:"data-bindto-template",dataParseWithAttr:"data-parse-with",bindAsTextOnly:false,insertPolyfills:true,parsingFunctionsObject:{},debugLogging:false};if(userOptionsObject!==undefined)options=$.extend(options,userOptionsObject);if(options.insertPolyfills===true)loadPolyFills();var modelsToMonitor=modelsToMonitorObject;var listenForEvents=(options.realtime?(GDB.helpers.isEventSupported("input")?"input":"keyup")+" paste ":"")+"blur";$(options.rootElementSelectorString).on(listenForEvents,"["+options.dataBindToAttr+"],["+options.dataBindToTemplateAttr+"]",function(){var $this=$(this);if($this.is("["+options.dataBindToAttr+"]")){var modelLocation=$this.attr(options.dataBindToAttr);if($this.is("input,select,textarea"))var value=$this.val();else value=options.bindAsTextOnly?$this.text():$this.html();eval("modelsToMonitor."+modelLocation+"="+"'"+value+"'");if(options.debugLogging)console.log(modelLocation+" is now equal to "+value)}});var observeObjects=function(e,t){$.each(e,function(e,n){if(n!==null&&typeof n==="object"||n instanceof Array){if(typeof t==="undefined")t=""+e;else{if(!isNaN(e))t+="["+e+"]";else t+="."+e}Object.observe(n,function(e){e.forEach(function(e){var n=!isNaN(e.name)?"["+e.name+"]":"."+e.name;var r="["+options.dataBindToAttr+"='"+t+n+"']";var i=e.object[e.name];if(!options.bindAsTextOnly)$(r).html(i);else $(r).text(i);if(options.debugLogging)console.log(t+n+" is now equal to "+i)})});observeObjects(n,t)}})};observeObjects(modelsToMonitor)};var loadPolyFills=function(){if(!Object.observe){(function(e,t){function r(e){return typeof Node==="object"?e instanceof Node:e&&typeof e==="object"&&typeof e.nodeType==="number"&&typeof e.nodeName==="string"}function i(e){return typeof HTMLElement==="object"?e instanceof HTMLElement:e&&typeof e==="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName==="string"}var n=function(e){var n=e.call(e),r=typeof r;return typeof t.alert==="object"?function(t){return n===e.call(t)||!!t&&typeof t.toString==r&&typeof t.valueOf==r&&/^\s*\bfunction\b/.test(""+t)}:function(t){return n===e.call(t)}}(e.prototype.toString);var s=function(){return!!t.setImmediate}();var o=function(){if(s){return function(e){return setImmediate(e)}}else{return function(e){return setTimeout(e,10)}}}();var u=function(){if(s){return function(e){clearImmediate(e)}}else{return function(e){clearTimeout(e)}}}();var a=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};var f=function(e,t){if(e===t){return e!==0||1/e===1/t}return e!==e&&t!==t};var l=function(e){if(typeof e==="undefined"){return false}return"get"in e||"set"in e};var c=function(e){if(typeof e==="undefined"){return false}return"value"in e||"writable"in e};var h=function(e,t){if(typeof e!=="object"){throw new TypeError("Object.observeObject called on non-object")}if(n(t)===false){throw new TypeError("Object.observeObject: Expecting function")}if(Object.isFrozen(t)===true){throw new TypeError("Object.observeObject: Expecting unfrozen function")}};var p=function(){var e=[];var t=function(t,n){h(t,n);Object.getNotifier(t).addListener(n);if(e.indexOf(t)===-1){e.push(t)}else{Object.getNotifier(t)._checkPropertyListing()}};t.prototype.deliverChangeRecords=function(e){Object.getNotifier(e).deliverChangeRecords()};e.lastScanned=0;var n=function(e){return function(){var t=0,r=e.length,i=new Date,s=false;for(t=e.lastScanned;t<r&&!s;t++){Object.getNotifier(e[t])._checkPropertyListing();s=new Date-i>100}e.lastScanned=t<r?t:0;o(n)}}(e);o(n);return t}();var d=function(e){var t=[],n=[],r=false,i=[],s=[];var c=this;Object.defineProperty(c,"_watching",{enumerable:true,get:function(e){return function(){return e}}(e)});var h=function(e,t){var n=typeof e[t],r=Object.getOwnPropertyDescriptor(e,t);if(t==="getNotifier"||l(r)||!r.enumerable){return false}if(e instanceof Array&&a(t)){var o=i.length;i[o]=t;s[o]=e[t];return true}(function(t,n){i[t]=n;s[t]=e[n];Object.defineProperty(e,n,{get:function(){return s[t]},set:function(r){if(!f(s[t],r)){Object.getNotifier(e).queueUpdate(e,n,"updated",s[t]);s[t]=r}}})})(i.length,t);return true};c._checkPropertyListing=function(e){var t=c._watching,n=Object.keys(t),r=0,o=n.length;var u=[],f=i.slice(0),l=[];var p,d=!e,v,m,g,y;if(t instanceof Array){y=i.length}for(r=0;r<o;r++){p=n[r];m=t[p];v=typeof m;if((g=i.indexOf(p))===-1){if(h(t,p)&&d){c.queueUpdate(t,p,"new",null,t[p])}}else{if(t instanceof Array&&a(p)){if(s[g]!==m){if(d){c.queueUpdate(t,p,"updated",s[g],m)}s[g]=m}}f.splice(f.indexOf(p),1)}}if(t instanceof Array&&t.length!==y){if(d){c.queueUpdate(t,"length","updated",y,t)}}if(d){o=f.length;for(r=0;r<o;r++){g=i.indexOf(f[r]);c.queueUpdate(t,f[r],"deleted",s[g]);i.splice(g,1);s.splice(g,1)}}};c.addListener=function(e){var n=t.indexOf(e);if(n===-1){t.push(e)}};c.removeListener=function(e){var n=t.indexOf(e);if(n>-1){t.splice(n,1)}};c.listeners=function(){return t};c.queueUpdate=function(e,t,n,r){this.queueUpdates([{type:n,object:e,name:t,oldValue:r}])};c.queueUpdates=function(e){var t=this,i=0,s=e.length||0,a;for(i=0;i<s;i++){a=e[i];n.push(a)}if(r){u(r)}r=o(function(){r=false;t.deliverChangeRecords()})};c.deliverChangeRecords=function(){var e=0,r=t.length,i;for(e=0;e<r;e++){if(t[e]){if(t[e]===console.log){console.log(n)}else{t[e](n)}}}n=[]};c._checkPropertyListing(true)};var v=[],m=[];e.getNotifier=function(e){var t=m.indexOf(e),n=t>-1?v[t]:false;if(!n){t=m.length;m[t]=e;n=v[t]=new d(e)}return n};e.observe=function(e,t){if(!i(e)){return new p(e,t)}};e.unobserve=function(e,t){h(e,t);var n=m.indexOf(e),r=n>-1?v[n]:false;if(!r){return}r.removeListener(t);if(r.listeners().length===0){m.splice(n,1);v.splice(n,1)}}})(Object,this)}if(!Array.prototype.forEach){Array.prototype.forEach=function(e){"use strict";if(this===void 0||this===null)throw new TypeError;var t=Object(this);var n=t.length>>>0;if(typeof e!=="function")throw new TypeError;var r=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<n;i++){if(i in t)e.call(r,t[i],i,t)}}}}})